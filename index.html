<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>ç›®æŒ‡ã›ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãƒã‚¹ã‚¿ãƒ¼ï¼</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      padding: 20px;
      background: #f5f5f5;
      line-height: 1.6;
      overflow-x: hidden;
    }
    h1 {
      font-size: 1.6rem;
    }
    h2 {
      margin-top: 1.4em;
    }
    button {
      margin-top: 8px;
      padding: 8px 16px;
      cursor: pointer;
    }
    /* ã‚³ãƒ¼ãƒ‰ç·¨é›†ã‚¨ãƒªã‚¢ */
    .code {
      width: 100%;
      min-height: 200px;
      background: #222;
      color: #eee;
      border-radius: 6px;
      padding: 10px;
      font-family: "SF Mono", monospace;
      white-space: pre;
      overflow: visible;
      box-sizing: border-box;
    }
    /* å…ç«¥ãŒæ›¸ãæ›ãˆã‚‹1è¡Œã ã‘ç›®ç«‹ãŸã›ã‚‹ */
    .editable-line {
      background: #ffeb3b;
      color: #000;
      font-weight: bold;
      padding: 2px 4px;
      border-radius: 4px;
    }
    /* å‡ºåŠ›æ¬„ */
    #output1, #output2 {
      margin-top: 10px;
      padding: 10px;
      background: #ffffff;
      border-radius: 6px;
      min-height: 3em;
      white-space: pre-wrap;
      border: 1px solid #cccccc;
      box-sizing: border-box;
      font-family: system-ui, sans-serif;
    }

    /* ğŸŒŸ æ­£è§£ã—ãŸã¨ãã®å…‰ã‚‹æ¼”å‡º */
    .correct-flash {
      animation: correctFlash 0.9s ease-out;
      box-shadow: 0 0 12px 6px gold;
    }
    @keyframes correctFlash {
      0% Â { background: #fff59d; }
      50% { background: #ffe082; transform: scale(1.03); }
      100% { background: #ffffff; transform: scale(1); }
    }

    /* âŒ ä¸æ­£è§£ã—ãŸã¨ãã®æ¼”å‡º (New) */
    .incorrect-flash {
      animation: incorrectFlash 0.4s ease-out;
      border: 2px solid #ff5252 !important; /* ä¸€æ™‚çš„ã«èµ¤ã„æ ç·š */
    }
    @keyframes incorrectFlash {
      0%, 100% { transform: translateX(0); background: #ffffff; }
      25% { transform: translateX(-5px); background: #ffebee; }
      75% { transform: translateX(5px); background: #ffebee; }
    }

    /* âœ¨ ã‚­ãƒ©ã‚­ãƒ©ç²’å­ï¼ˆãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«ï¼‰ */
    .particle {
      position: fixed;
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: rgba(255,255,255,0.9);
      pointer-events: none;
      animation: fall 1.2s linear forwards;
      filter: drop-shadow(0 0 6px #fff);
      z-index: 9999;
    }
    @keyframes fall {
      0% Â  { opacity: 1; transform: translateY(0) Â  scale(1); Â  }
      100% { opacity: 0; transform: translateY(80px) scale(0.3); }
    }

    /* ãƒ’ãƒ³ãƒˆè¡¨ç¤ºç”¨ */
    #hint-box {
      margin-top: 10px;
      padding: 10px;
      background: #ffffff;
      border-radius: 6px;
      border: 1px solid #dddddd;
      font-size: 0.95rem;
    }
    .hint-text {
      margin-top: 6px;
      padding: 6px 8px;
      background: #f9f9f9;
      border-radius: 4px;
      border-left: 3px solid #90caf9;
      display: none;
    }

    /* ã‚³ãƒ”ãƒ¼ãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« (New) */
    .copy-btn {
      padding: 4px 8px;
      margin-top: 0; /* æ—¢å­˜ã®buttonãƒãƒ¼ã‚¸ãƒ³ã‚’ä¸Šæ›¸ã */
      font-size: 0.85rem;
      background-color: #4CAF50; /* ç·‘è‰² */
      color: white;
      border: none;
      border-radius: 4px;
      transition: background-color 0.2s;
      flex-shrink: 0; /* ç¸®ã¾ãªã„ã‚ˆã†ã«ã™ã‚‹ */
    }
    .copy-btn:hover {
      background-color: #45a049;
    }
    .copy-container {
      display: flex; 
      align-items: center; 
      justify-content: space-between; 
      gap: 10px;
      background: #eee;
      padding: 4px;
      border-radius: 4px;
      border: 1px solid #ddd;
    }
    #codeToCopy {
      font-family: monospace;
      font-weight: bold;
      color: #333;
      flex-grow: 1;
    }
  </style>
</head>
<body>
  <h1>âœ¨ 1ã‘ãŸ & 4ã‘ãŸ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ã•ãŒãã†ï¼</h1>

  <div id="helper">
    <p>ğŸŒŸ <strong>ãƒ«ãƒ¼ãƒ«</strong></p>
    <p>1ã‘ãŸ ã¨ 4ã‘ãŸ ã® ã²ã¿ã¤ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ã¿ã¤ã‘ã‚ˆã†ï¼</p>
  </div>

  <!-- ç¬¬1å• -->
  <h2>ç·´ç¿’ï¼š1ã‘ãŸã®ã²ã¿ã¤æ•°å­—ã‚’å½“ã¦ã¦ã¿ã‚ˆã†ï¼</h2>
  <pre id="editor1" class="code" contenteditable="true">function solve() {
  // â–¼1è¡Œã ã‘æ›¸ãã‹ãˆã¦OKï¼
  <span class="editable-line">const candidate = "0";</span> // â† ã“ã“ã‚’ ã˜ã¶ã‚“ã§æ›¸ãã‹ãˆã‚‹

  if (checkPassword1(candidate)) {
    log("ã›ã„ã‹ã„ï¼ ã€Œ" + candidate + "ã€ ã ã‚ˆ âœ¨");
  } else {
    log("ã¡ãŒã†ã‚ˆï¼ ã‚‚ã†ã„ã¡ã©ãŸã‚ãã†");
  }
}
solve();</pre>
  <button id="run1">ç¬¬1å• å®Ÿè¡Œï¼</button>
  <div id="output1"></div>

  <!-- æœ¬ç•ª -->
  <h2>â‘¡ ç¬¬2å•ï¼šç·å½“ãŸã‚Šã§ 4ã‘ãŸã®ç§˜å¯†ã®æ•°å­—ã‚’è¦‹ã¤ã‘ã‚ˆã†ï¼</h2>
  <p>ãã¿ãŒæ›¸ãã®ã¯ã€<strong>ã€Œã—ã‚‰ã¹ã‚‹4ã‘ãŸã®æ•°å­—ã‚’ä½œã‚‹ 1è¡Œã€</strong>ã ã‘ï¼</p>

  <!-- æ®µéšãƒ’ãƒ³ãƒˆã‚³ãƒ¼ãƒŠãƒ¼ -->
  <div id="hint-box">
    <strong>ğŸ” ã†ã¡ã“ã‚€ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã¦ã¿ã‚ˆã†ï¼</strong>
    <div>
      <button type="button" data-hint="1">ãƒ’ãƒ³ãƒˆã®ã‚³ãƒ¼ãƒ‰ã‚’è¡¨ç¤º</button>
    </div>
    <div id="hint1" class="hint-text">
      <p>ä»Šå›ã¯ã“ã‚Œã‚’æ‰“ã¡è¾¼ã‚‚ã†ï¼</p>
      <div class="copy-container">
        <code id="codeToCopy">const candidate = digits[a] + digits[b] + digits[c] + digits[d]</code>
        <button id="copyHintBtn" class="copy-btn">ã‚³ãƒ”ãƒ¼</button>
      </div>
    </div>
  </div>


  <pre id="editor2" class="code" contenteditable="true">function solve() {
  const digits = ["0","1","2","3","4","5","6","7","8","9"];
  let count = 0;
   //ä¸‹ã®è¡Œã§ã€0~9ã¾ã§ã‚’ç·å½“ãŸã‚Šã§è€ƒãˆã‚‹ã‚ˆã€‚
  for (let a = 0; a < 10; a++) {
    for (let b = 0; b < 10; b++) {
      for (let c = 0; c < 10; c++) {
        for (let d = 0; d < 10; d++) {

          <span class="editable-line">const candidate = "0000";</span> // â† ã“ã“ã®1è¡Œã ã‘ã‚’ ã˜ã¶ã‚“ã§æ›¸ãã‹ãˆã‚‹ï¼

          count++;
          if (checkPassword2(candidate)) {
            log("ã¿ã¤ã‘ãŸï¼ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯ã€Œ" + candidate + "ã€âœ¨");
            log("ãŸã‚ã—ãŸå›æ•°: " + count + " å›");
            return;
          }
        }
      }
    }
  }
  log("ã¿ã¤ã‘ã‚‰ã‚Œãªã‹ã£ãŸã‚ˆâ€¦ ã¾ã  candidate ã® 1è¡ŒãŒ ã¡ãŒã†ã‹ã‚‚ï¼Ÿ");
}
solve();</pre>
  <button id="run2">ç¬¬2å• å®Ÿè¡Œï¼</button>
  <div id="output2"></div>

  <script>
    // ã²ã¿ã¤ã®ç­”ãˆ
    const SECRET1 = "3";
    const SECRET2 = "0213";

    // æ¼”å‡ºã‚ªãƒ³ã‚ªãƒ•ï¼ˆæœ€åˆã¯ã‚ªãƒ•ã«ã—ã¦ãŠãã€ãƒ†ã‚¹ãƒˆå¾Œã«ã‚ªãƒ³ï¼‰
    let enableEffects = false;

    // âœ¨ ç²’å­ã‚’é™ã‚‰ã›ã‚‹é–¢æ•°
    function spawnParticles() {
      for (let i = 0; i < 40; i++) {
        const p = document.createElement("div");
        p.className = "particle";
        p.style.left = (Math.random() * window.innerWidth) + "px";
        p.style.top Â = (Math.random() * 40) + "px";
        p.style.background = `hsl(${Math.random()*360}, 90%, 80%)`;
        document.body.appendChild(p);
        setTimeout(() => p.remove(), 1200);
      }
    }

    // æ­£è§£æ¼”å‡º
    function triggerCorrectEffect(problemIndex) {
      if (!enableEffects) return;

      const out = problemIndex === 1
        ? document.getElementById("output1")
        : document.getElementById("output2");

      if (!out) return;

      // å…‰ã‚‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
      out.classList.remove("correct-flash");
      void out.offsetWidth; Â // reflow ã§ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒªã‚»ãƒƒãƒˆ
      out.classList.add("correct-flash");

      // ã‚­ãƒ©ã‚­ãƒ©ç²’å­
      spawnParticles();

      const marker = "ğŸ‰ ãŠã¿ã”ã¨ï¼ã›ã„ã‹ã„ã§ã™ï¼";
      if (!out.textContent.includes(marker)) {
        out.textContent += "\n" + marker;
      }
    }

    // âŒ ä¸æ­£è§£æ¼”å‡º (New)
    function triggerIncorrectEffect(problemIndex) {
      if (!enableEffects) return;

      const out = problemIndex === 1
        ? document.getElementById("output1")
        : document.getElementById("output2");

      if (!out) return;

      // æºã‚Œã‚‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
      out.classList.remove("incorrect-flash");
      void out.offsetWidth; Â // reflow ã§ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒªã‚»ãƒƒãƒˆ
      out.classList.add("incorrect-flash");

      // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³çµ‚äº†å¾Œã«èµ¤ã„æ ç·šã‚’å…ƒã«æˆ»ã™ (0.4ç§’)
      setTimeout(() => {
         out.style.borderColor = "#cccccc";
         out.classList.remove("incorrect-flash");
      }, 400);
    }


    // æ¡ç‚¹ç”¨é–¢æ•°
    function checkPassword1(x) {
      const ok = (x === SECRET1);
      if (ok) {
        triggerCorrectEffect(1);
      } else {
        triggerIncorrectEffect(1); // ä¸æ­£è§£æ™‚ã«ã‚‚æ¼”å‡ºã‚’å‘¼ã³å‡ºã™
      }
      return ok;
    }
    function checkPassword2(x) {
      const ok = (x === SECRET2);
      if (ok) {
        triggerCorrectEffect(2);
      } else {
        triggerIncorrectEffect(2); // ä¸æ­£è§£æ™‚ã«ã‚‚æ¼”å‡ºã‚’å‘¼ã³å‡ºã™
      }
      return ok;
    }

    // ãƒ­ã‚°å‡ºåŠ›
    function logTo(div, msg) {
      div.textContent += msg + "\n";
    }

    // ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹é–¢æ•° (New)
    function copyToClipboard(text, buttonElement) {
      const textarea = document.createElement('textarea');
      textarea.value = text;
      document.body.appendChild(textarea);
      textarea.select();
      
      let success = false;
      try {
        success = document.execCommand('copy');
      } catch (err) {
        console.error('Copy failed:', err);
      }
      
      document.body.removeChild(textarea);

      if (success && buttonElement) {
        const originalText = buttonElement.textContent;
        const originalBg = buttonElement.style.backgroundColor;
        
        buttonElement.textContent = 'ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼';
        buttonElement.style.backgroundColor = '#2196F3'; // é’ã«å¤‰æ›´
        
        setTimeout(() => {
          buttonElement.textContent = originalText;
          buttonElement.style.backgroundColor = originalBg; // å…ƒã®è‰²ã«æˆ»ã™
        }, 1500);
      }
    }

    // DOM è¦ç´ å–å¾—
    const editor1 = document.getElementById("editor1");
    const editor2 = document.getElementById("editor2");
    const output1 = document.getElementById("output1");
    const output2 = document.getElementById("output2");
    const run1Btn = document.getElementById("run1");
    const run2Btn = document.getElementById("run2");

    // ãƒ’ãƒ³ãƒˆãƒœã‚¿ãƒ³ã®å‡¦ç†
    const hintButtons = document.querySelectorAll('#hint-box button[data-hint]');
    const hint1 = document.getElementById('hint1');
    const hint2 = document.getElementById('hint2');
    const hint3 = document.getElementById('hint3');

    hintButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        const level = btn.getAttribute('data-hint');
        if (level === '1') hint1.style.display = 'block';
      });
    });

    // ã‚³ãƒ”ãƒ¼ãƒœã‚¿ãƒ³ã®å‡¦ç† (New)
    const copyHintBtn = document.getElementById('copyHintBtn');
    const codeToCopy = document.getElementById('codeToCopy');
    
    if (copyHintBtn && codeToCopy) {
        copyHintBtn.addEventListener('click', () => {
            // å‰å¾Œã®ç©ºç™½ã‚„æ”¹è¡Œã‚’å‰Šé™¤ã—ã¦ã‚³ãƒ”ãƒ¼
            copyToClipboard(codeToCopy.textContent.trim(), copyHintBtn);
        });
    }

    // ç¬¬1å• å®Ÿè¡Œ
    run1Btn.onclick = () => {
      output1.textContent = "";
      const code = editor1.textContent; // contenteditable <pre> ã‹ã‚‰ã‚³ãƒ¼ãƒ‰æ–‡å­—åˆ—ã‚’å–å¾—
      const log = (m) => logTo(output1, m);

      try {
        // new Function() ã§æ–‡å­—åˆ—ã¨ã—ã¦å—ã‘å–ã£ãŸã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹
        new Function("checkPassword1", "log", code)(checkPassword1, log);
      } catch (e) {
        log("ã‚¨ãƒ©ãƒ¼: " + e.message);
      }
    };

    // ç¬¬2å• å®Ÿè¡Œ
    run2Btn.onclick = () => {
      output2.textContent = "";
      const code = editor2.textContent;
      const log = (m) => logTo(output2, m);

      try {
        // new Function() ã§æ–‡å­—åˆ—ã¨ã—ã¦å—ã‘å–ã£ãŸã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹
        new Function("checkPassword2", "log", code)(checkPassword2, log);
      } catch (e) {
        log("ã‚¨ãƒ©ãƒ¼: " + e.message);
      }
    };

    // --- ç°¡å˜ãªãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ï¼ˆé–‹ç™ºè€…å‘ã‘ï¼‰---
    console.assert(checkPassword1("3") Â  Â === true, Â 'checkPassword1("3") ã¯ true ã®ã¯ãš');
    console.assert(checkPassword1("0") Â  Â === false, 'checkPassword1("0") ã¯ false ã®ã¯ãš');
    console.assert(checkPassword2("0213") === true, Â 'checkPassword2("0213") ã¯ true ã®ã¯ãš');
    console.assert(checkPassword2("0000") === false, 'checkPassword2("0000") ã¯ false ã®ã¯ãš');

    // âœ… ãƒ†ã‚¹ãƒˆãŒçµ‚ã‚ã£ãŸã‚ã¨ã§ã€æ¼”å‡ºã‚’ã‚ªãƒ³ã«ã™ã‚‹
    enableEffects = true;
  </script>
</body>
</html>
